# Results



## Time series analysis
The majority of the recorded crime in this dataset is happened in 2022 (>99%). Therefore, we focus on the time series analysis in 2022. Because of the release date of the dataset, we only have data before October.

```{r count_year}
library(tidyverse)
library(dplyr)
library(lubridate)
df$cmplnt_fr_dt <- as.Date(df$cmplnt_fr_dt)
df_ts <- df %>% mutate(year_occur = year(df$cmplnt_fr_dt), month_occur = month(df$cmplnt_fr_dt))
df_y_occur <- as.data.frame(table(df_ts$year_occur), col.names<- names(c("Year", "Freq")) )
num2021 <- sum(df_y_occur$Freq[1:22])
df_temp <- as.data.frame(matrix(c("<2022", "2022", num2021, df_y_occur$Freq[23]),nrow = 2))
colnames(df_temp) <- c("Year", "Count")
knitr::kable(df_temp)
```

### Occurence Analysis
```{r Occurence_2022}
df_ts_22 <- df_ts %>% filter(year_occur == 2022)
df_occur_count <- as.data.frame(table(df_ts_22$cmplnt_fr_dt))
df_occur_count$Var1<- as.Date(df_occur_count$Var1)
p_occurence <- ggplot(df_occur_count) + geom_path(mapping = aes(x = Var1, y = Freq)) + xlab("Date") + ylab("Occurance") + ggtitle("Occurence of Crime in 2022")
ggsave(p_occurence, filename = "./figure/occurence_2022.png")
p_occurence
```

We can see from the above plot that the number of crimes in 2022 from January to October goes gradually up then down. It indicates that the number of crimes may have a positive correlation to the temperature. When weather is warmer, there tends to be more crimes. 

```{r Occurence_time_2022}
df_ts_22 <- df_ts_22 %>%mutate(hms = as.POSIXct(cmplnt_fr_tm, format = "%H:%M:%OS"))
df_ts_22 <- df_ts_22 %>%mutate(hour = hour(hms))
df_occur_hour_count <- as.data.frame(table(df_ts_22$hour))
ggplot(df_occur_hour_count, mapping = aes(x = Var1, y = Freq, group=1))+geom_line() +geom_point()+xlab("Hour") + ylab("Occurance") + ggtitle("Occurence of crime at different times of the day in 2022")
```

This plot shos the occurrence of crime at difference times of the day in 2022. The occurrence of crime reaches to its lowest in the morning then gradually goes up. It reaches its peak at 3-5 p.m. then goes down. It's against to our intuitation that most crime occurs at night. In fact, most of the crime occurs in the daytime, especially in the afternoon.

### Law Category Analysis

```{r Occurence_law_2022}

df_law_22 <- df_ts_22 %>% group_by(law_cat_cd) %>% count(cmplnt_fr_dt)
ggplot(df_law_22, mapping = aes(x = cmplnt_fr_dt, y = n, group = law_cat_cd, color = law_cat_cd)) + geom_line() +labs(x = "Date", y = "Occurence", title = "Occurence of Crime in Different Law Categories in 2022", color = "Law Category")
```

The plot shows the occurrence of crime falling in different law categories in 2022. We can see from the plot the occurrence in decreasing number is misdemeanor, felony and violation. They all experience an increase and decrease in trend of occurrence in 2022. Moreover, occurrence of misdemeanor has the highest variance while the occurrence of violation is the most stable among the occurrences of these three kinds of crimes.

```{r Occurence_law_hour_2022}

df_law_22 <- df_ts_22 %>% group_by(law_cat_cd) %>% count(hour)
df_law_22$hour <- as.factor(df_law_22$hour)
ggplot(df_law_22, mapping = aes(x = hour, y = n, group = law_cat_cd, color = law_cat_cd)) + geom_line() +labs(x = "Hour", y = "Occurence", title = "Occurence of Crimes in Different Law Categories in Different Time of a Day in 2022", color = "Law Category")
```


The above graph shows the crimes of all three categories reaches their lowest points at 5-6 a.m.. And they reaches their highest points at 3-5 p.m.. We can also see from the plot that in the night, there is another peak for felony and the rate of felony in all categories of crimes goes up. It's to our intuition that the felony often occur at midnight. 
